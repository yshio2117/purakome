<div class="border-0 border-start border-2 ps-2" id="cm{{comment.id}}">
        <div class="mt-3">
            <strong>{{comment.user_name}}</strong> 
            {% if  comment.parent.user_name%}さんから<strong>{{comment.parent.user_name}}</strong>さん{% endif %}
            <small class="text-muted">On {{ comment.created }}</small>
        </div>
        <div class="border p-2 rounded">
            <p>{{comment.message}}</p>
            <button class="btn btn-info btn-sm" onclick="handleReply({{comment.id}})">返信</button>
        
            <div id="reply-form-container-{{comment.id}}" style="display:none">
            
                <form method="post" action="{% url 'reply' %}" class="mt-3">
                    {% csrf_token %}
                    <input type="hidden" name="post_id" value="{{post.id}}">
                    <input type="hidden" name="parent" value="{{comment.id}}">
                    <input type="hidden" name="post_url" value="{{post.get_absolute_url_title}}">
                    {{comment_form.as_p}}
                    <div>
                        <button type="button" onclick="handleCancel({{comment.id}})" class="btn btn-light border btn-sm">キャンセル</button>
                        <button type="submit" class="btn btn-info btn-sm">送信</button>
                    </div>
                </form>
            </div>
        </div>
        {% for comment in comment.get_comments %}
            {% include 'sentiment/anime/comment.html' with comment=comment %}
        {% endfor %}
</div>

<script>

function handleReply(response_id) {
    const reply_form_container = document.querySelector(`#reply-form-container-${response_id}`)
    if (reply_form_container) {
        reply_form_container.style.display = 'block';
    }
}
function handleCancel(response_id) {
    const reply_form_container = document.querySelector(`#reply-form-container-${response_id}`)
    if (reply_form_container) {
        reply_form_container.style.display = 'none';
    }
}

</script>
